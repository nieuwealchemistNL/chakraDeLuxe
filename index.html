<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Chakra Code DeLuxe Analyse ‚Äì nieuwealchemist.nl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.5;
    }
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #1f2937 0, #020617 45%, #000 100%);
      color: #e5e7eb;
    }
    .app {
      max-width: 1024px;
      margin: 0 auto;
      padding: 2rem 1.5rem 4rem;
    }
    h1, h2, h3 {
      color: #facc15;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 0.75rem;
    }
    h2 {
      font-size: 1.35rem;
      border-bottom: 1px solid #1f2937;
      padding-bottom: 0.3rem;
    }
    h3 {
      font-size: 1.05rem;
      margin-top: 1rem;
    }
    p {
      margin: 0.25rem 0 0.6rem;
    }
    .card {
      background: rgba(2,6,23,0.96);
      border-radius: 0.9rem;
      padding: 1.25rem 1.5rem;
      box-shadow: 0 22px 60px rgba(0,0,0,0.7);
      border: 1px solid #1e293b;
      backdrop-filter: blur(14px);
    }
    .input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: flex-end;
      margin-bottom: 1rem;
    }
    label {
      font-weight: 500;
      font-size: 0.9rem;
    }
    input[type="date"],
    input[type="text"],
    input[type="email"] {
      padding: 0.4rem 0.6rem;
      border-radius: 0.5rem;
      border: 1px solid #4b5563;
      background: #020617;
      color: #e5e7eb;
      font-size: 0.9rem;
      min-width: 180px;
    }
    input[type="date"]:focus,
    input[type="text"]:focus,
    input[type="email"]:focus {
      outline: 2px solid #facc15;
      outline-offset: 1px;
      border-color: #facc15;
    }
    button {
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #f97316, #facc15);
      color: #111827;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      box-shadow: 0 10px 25px rgba(250,204,21,0.35);
      white-space: nowrap;
    }
    button.secondary {
      background: #020617;
      color: #e5e7eb;
      border: 1px solid #4b5563;
      box-shadow: none;
    }
    button:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
    }
    button:active {
      transform: translateY(0);
      box-shadow: 0 6px 15px rgba(250, 204, 21, 0.25);
    }
    .error {
      color: #fecaca;
      font-size: 0.9rem;
      margin-top: 0.25rem;
    }
    .tagline {
      font-size: 0.95rem;
      color: #9ca3af;
      margin-bottom: 1rem;
    }
    .pill {
      display: inline-block;
      border-radius: 999px;
      padding: 0.1rem 0.6rem;
      font-size: 0.75rem;
      background: #111827;
      border: 1px solid #374151;
      margin-right: 0.25rem;
      margin-bottom: 0.25rem;
    }
    .section {
      margin-top: 1.25rem;
      padding-top: 0.5rem;
    }
    .small {
      font-size: 0.82rem;
      color: #9ca3af;
    }
    ul {
      margin: 0.25rem 0 0.8rem 1.25rem;
      padding: 0;
    }
    li {
      margin-bottom: 0.2rem;
    }
    .muted {
      color: #9ca3af;
      font-size: 0.85rem;
    }
    .actions-below {
      margin-top: 0.75rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .report-footer {
      margin-top: 1.25rem;
      border-top: 1px solid #1f2937;
      padding-top: 0.5rem;
      font-size: 0.8rem;
      color: #9ca3af;
      text-align: right;
    }
    .badge {
      display:inline-block;
      padding:0.1rem 0.5rem;
      border-radius:999px;
      border:1px solid #4b5563;
      font-size:0.7rem;
      text-transform:uppercase;
      letter-spacing:0.05em;
      color:#9ca3af;
      margin-left:0.4rem;
    }
    @media (min-width: 768px) {
      .input-row {
        justify-content: flex-start;
      }
    }
    @media print {
      body {
        background: #ffffff;
        color: #000000;
      }
      .card {
        box-shadow: none;
        border-radius: 0;
        border: none;
      }
      .app > .card:first-child {
        display: none;
      }
      .report-footer {
        color: #555555;
      }
    }
  </style>
</head>
<body>
  <main class="app">
    <div class="card">
      <h1>Chakra Code DeLuxe Analyse</h1>
      <p class="tagline">
        Ontvang een <strong>diepgaand, symbolisch DeLuxe rapport</strong> op basis van je geboortedatum:
        chakra-profiel, zielscyclus, zielscontracten, karmische lijnen, gidsen, jaartrilling en zielsmissie.
      </p>

      <div class="input-row">
        <div>
          <label for="dob">Geboortedatum</label><br />
          <input type="date" id="dob" />
        </div>
        <div>
          <label for="name">Naam (optioneel)</label><br />
          <input type="text" id="name" placeholder="Bijv. Emma, Jan, ..." />
        </div>
        <div>
          <label for="email">E-mailadres (optioneel)</label><br />
          <input type="email" id="email" placeholder="samenvatting naar dit adres..." />
        </div>
        <div>
          <button id="analyzeBtn" type="button">
            üîÆ Genereer DeLuxe rapport
          </button>
        </div>
      </div>
      <div id="error" class="error" style="display:none;"></div>
      <p class="small">
        Deze tool werkt volledig in de browser. Er worden geen gegevens opgeslagen of verstuurd.<br/>
        Alle duiding is symbolisch en bedoeld als uitnodiging tot zelfinzicht en reflectie ‚Äì niets ligt vast.
      </p>
    </div>

    <div id="report" class="card section" style="margin-top:1.5rem; display:none;"></div>

    <div id="reportActions" class="actions-below" style="display:none;">
      <button id="printBtn" type="button" class="secondary">üñ® Printen / Exporteer als PDF</button>
      <button id="emailBtn" type="button" class="secondary">‚úâ Stuur samenvatting per e-mail</button>
    </div>
  </main>

  <script>
    // ------------------------------
    // Basisdata: chakra-meta & oefeningen
    // ------------------------------
    const chakraMeta = {
      1: {
        naam: "1 ‚Äì Wortelchakra",
        kern: "basis, veiligheid, structuur, lichamelijke aanwezigheid",
        kracht: "je bent nuchter, praktisch en geeft anderen een gevoel van stabiliteit.",
        groei: "verandering kan spannend zijn; je mag vertrouwen dat nieuwe stappen ook veiligheid kunnen brengen."
      },
      2: {
        naam: "2 ‚Äì Sacraalchakra",
        kern: "emoties, verbinding, creativiteit, sensualiteit",
        kracht: "je voelt veel, hebt oog voor sfeer en verbindt graag van hart tot hart.",
        groei: "je mag leren om je eigen grenzen te voelen en te bewaken, zodat je niet overprikkeld raakt."
      },
      3: {
        naam: "3 ‚Äì Zonnevlecht",
        kern: "wilskracht, richting, identiteit, eigenwaarde",
        kracht: "je hebt een natuurlijke innerlijke kracht en je kunt richting geven aan je leven.",
        groei: "zelftwijfel en perfectionisme mogen zachter; je hoeft niet alles perfect te doen om waardig te zijn."
      },
      4: {
        naam: "4 ‚Äì Hartchakra",
        kern: "liefde, empathie, zachtheid, menselijkheid",
        kracht: "je bent loyaal, warm en je hart staat open voor de mensen die je toelaat.",
        groei: "je mag leren ontvangen in plaats van alleen geven."
      },
      5: {
        naam: "5 ‚Äì Keelchakra",
        kern: "communicatie, waarheid, jezelf uitspreken",
        kracht: "je hebt een sterke innerlijke waarheid en de potentie om helder te spreken.",
        groei: "je mag jezelf eerder laten horen, ook als het nog niet perfect geformuleerd is."
      },
      6: {
        naam: "6 ‚Äì Derde Oog",
        kern: "inzicht, intu√Øtie, overzicht, innerlijke visie",
        kracht: "je ziet patronen, begrijpt dingen snel en hebt een sterk innerlijk kompas.",
        groei: "je mag minder overdenken en meer vertrouwen op je eerste gevoel."
      },
      7: {
        naam: "7 ‚Äì Kruinchakra",
        kern: "bewustzijn, zingeving, reflectie, spirituele visie",
        kracht: "je denkt graag diep na en zoekt naar betekenis achter ervaringen.",
        groei: "je mag af en toe meer in het lichaam zakken en genieten van het moment."
      },
      8: {
        naam: "8 ‚Äì Krachtcentrum / Aura",
        kern: "verantwoordelijkheid, grenzen, leiderschap, draagkracht",
        kracht: "je hebt een sterke ruggengraat en mensen vertrouwen op jouw stabiliteit.",
        groei: "je mag minder dragen; niet alles en iedereen is jouw verantwoordelijkheid."
      },
      9: {
        naam: "9 ‚Äì Bronchakra",
        kern: "wijsheid, afronding, zielsdiepte, levenslessen",
        kracht: "je hebt een natuurlijke diepgang en begrijpt de grote lijnen van het leven.",
        groei: "je mag leren om de pijn van anderen niet volledig in je eigen systeem op te slaan."
      }
    };

    const zeroMeta = {
      kern: "gevoeligheid, open potentieel, innerlijke ruimte",
      uitleg: "De 0 staat niet voor een chakra, maar voor open ruimte en potentieel. Ze versterkt andere cijfers en wijst op gevoeligheid en ontvankelijkheid voor energie van buitenaf."
    };

    // Chakra-oefeningen per chakra (ontwikkel-gericht, symbolisch)
    const chakraExercises = {
      1: {
        titel: "Grondingsritueel voor wortelkracht",
        korte: "Versterk je basis door dagelijks kort bewust te landen in je lichaam en in het hier en nu.",
        stappen: [
          "Ga zitten met beide voeten plat op de grond.",
          "Adem drie keer diep in en uit, richting je buik.",
          "Visualiseer een warme, stevige vloer onder je die je draagt.",
          "Zeg rustig: ‚ÄúIk ben veilig. Ik mag hier zijn.‚Äù",
          "Voel 1 minuut lang alleen je voeten en adem."
        ]
      },
      2: {
        titel: "Emotie check-in voor sacraalchakra",
        korte: "Leer je emoties herkennen door ze dagelijks heel simpel te benoemen.",
        stappen: [
          "Sluit je ogen en adem rustig in en uit.",
          "Vraag jezelf: ‚ÄúWelke emotie is nu het meest aanwezig?‚Äù",
          "Kies √©√©n woord: blij, moe, gespannen, rustig, verdrietig, opgelucht‚Ä¶",
          "Zeg zacht: ‚ÄúHet is ok√© dat ik me zo voel.‚Äù",
          "Schrijf het woord eventueel in een notitieboek."
        ]
      },
      3: {
        titel: "Mini-richtingoefening voor zonnevlcht",
        korte: "Versterk je innerlijke richting met √©√©n kleine bewuste keuze per dag.",
        stappen: [
          "Vraag jezelf ‚Äôs ochtends: ‚ÄúWat wil IK vandaag echt?‚Äù",
          "Kies √©√©n kleine, haalbare actie die klopt voor jou.",
          "Schrijf die actie op of spreek hem hardop uit.",
          "Zet een klein vinkje als je het gedaan hebt.",
          "Evalueer ‚Äôs avonds kort: ‚ÄúHoe voelde dit?‚Äù"
        ]
      },
      4: {
        titel: "Hartademhaling & dankbaarheid",
        korte: "Open je hartenergie door aandacht te geven aan dankbaarheid.",
        stappen: [
          "Leg je hand op je hart en adem rustig in en uit.",
          "Denk aan √©√©n moment of persoon waar je dankbaar voor bent.",
          "Adem dat gevoel als het ware in je borstgebied.",
          "Zeg zacht: ‚ÄúDankjewel dat dit in mijn leven is.‚Äù",
          "Blijf nog 30 seconden bij dat gevoel."
        ]
      },
      5: {
        titel: "Keelchakra Express ‚Äì kleine waarheid",
        korte: "Oefen jezelf in uitspreken met √©√©n eerlijke zin per dag.",
        stappen: [
          "Sta even stil bij een situatie waar je iets voelde maar zweeg.",
          "Formuleer √©√©n eenvoudige, eerlijke zin (bijv. ‚ÄúIk ben moe.‚Äù).",
          "Oefen deze zin eerst hardop, alleen.",
          "Kies √©√©n veilig moment om de zin zachtjes te delen met een ander.",
          "Complimenteer jezelf dat je je stem hebt gebruikt, hoe klein ook."
        ]
      },
      6: {
        titel: "Intu√Øtief schrijven voor derde oog",
        korte: "Verfijn je intu√Øtie door korte, onbevangen schrijfmomenten.",
        stappen: [
          "Neem pen en papier of een notitie-app.",
          "Zet een timer op 3 minuten.",
          "Schrijf zonder te stoppen wat er in je opkomt, zonder te oordelen.",
          "Lees het niet direct terug; laat het even liggen.",
          "Bekijk later wat je opvalt aan patronen, herhalingen of ingevingen."
        ]
      },
      7: {
        titel: "Bewustzijnscheck ‚Äì betekenis voelen",
        korte: "Maak bewust ruimte voor zingeving zonder te verdwalen in denken.",
        stappen: [
          "Ga rustig zitten en adem drie keer diep in en uit.",
          "Vraag jezelf: ‚ÄúWat was vandaag betekenisvol, hoe klein ook?‚Äù",
          "Noem √©√©n moment en benoem waarom het betekenis had.",
          "Laat het antwoord even stil inwerken zonder meteen te analyseren.",
          "Sluit af met: ‚ÄúIk erken dat mijn leven ook in kleine dingen zin heeft.‚Äù"
        ]
      },
      8: {
        titel: "Grenzen & draagkracht scan",
        korte: "Onderzoek dagelijks wat echt van jou is en wat niet.",
        stappen: [
          "Schrijf drie dingen op die je vandaag ‚Äòmoet‚Äô doen.",
          "Vraag per punt: ‚ÄúIs dit werkelijk mijn verantwoordelijkheid?‚Äù",
          "Schrap √©√©n ding of delegeer waar mogelijk.",
          "Zeg zacht: ‚ÄúIk hoef niet alles te dragen om waardevol te zijn.‚Äù",
          "Plan een klein herstelmoment voor jezelf in (thee, wandeling, stilte)."
        ]
      },
      9: {
        titel: "Broncontact ‚Äì zachte terugblik",
        korte: "Activeer je wijsheid door kort terug te kijken op de dag.",
        stappen: [
          "Aan het einde van de dag: sluit je ogen en adem rustig.",
          "Vraag: ‚ÄúWat heeft deze dag mij willen leren?‚Äù",
          "Laat spontaan een beeld, gevoel of gedachte opkomen.",
          "Schrijf √©√©n zin op als boodschap aan jezelf.",
          "Sluit af met: ‚ÄúIk vertrouw dat ik mag leren in mijn eigen tempo.‚Äù"
        ]
      }
    };

    // ------------------------------
    // Hulpfuncties
    // ------------------------------
    function digitSum(n) {
      let s = n;
      while (s > 9) {
        s = String(s).split("").map(d => parseInt(d, 10)).reduce((a, b) => a + b, 0);
      }
      return s;
    }

    function formatDateDisplay(isoStr) {
      const [y, m, d] = isoStr.split("-");
      return `${d}-${m}-${y}`;
    }

    function analyzeDate(isoDate, name) {
      const clean = isoDate.replace(/\D/g, "");
      const digits = clean.split("").map(d => parseInt(d, 10));
      if (digits.length < 6) {
        throw new Error("Ongeldige geboortedatum.");
      }

      const firstSum = digits.reduce((a, b) => a + b, 0);
      const baseChakra = digitSum(firstSum);

      const counts = Array(10).fill(0);
      digits.forEach(d => counts[d]++);

      const firstSumStr = String(firstSum);
      const boven = firstSumStr.length > 1 ? parseInt(firstSumStr[0], 10) : baseChakra;
      const onder = firstSumStr.length > 1 ? parseInt(firstSumStr[1], 10) : null;

      return {
        name,
        isoDate,
        dateDisplay: formatDateDisplay(isoDate),
        digits,
        firstSum,
        baseChakra,
        counts,
        boven,
        onder
      };
    }

    function getAgeYears(isoDate) {
      const [y, m, d] = isoDate.split("-").map(n => parseInt(n, 10));
      const birth = new Date(y, m - 1, d);
      const today = new Date();
      let age = today.getFullYear() - birth.getFullYear();
      const mDiff = today.getMonth() - birth.getMonth();
      if (mDiff < 0 || (mDiff === 0 && today.getDate() < birth.getDate())) {
        age--;
      }
      return age;
    }

    // 7-jarige zielscyclus: symbolisch, cycli van 7 jaar
    function getSoulCycle(isoDate) {
      const age = getAgeYears(isoDate);
      const cycleIndex = Math.floor(age / 7) + 1; // 1e cyclus = 0-6
      const startAge = (cycleIndex - 1) * 7;
      const endAge = startAge + 6;

      const themes = {
        1: "Leren aarden, basisveiligheid en eerste indrukken van de wereld.",
        2: "Emotionele ontwikkeling, spel, relationele eerste ervaringen.",
        3: "Identiteit, eigen wil, grenzen en 'ik' tegenover de ander.",
        4: "Hartopening, vriendschappen, groepservaringen en empathie.",
        5: "Stem, expressie, jezelf meer uitspreken en laten zien.",
        6: "Inzicht, studie, innerlijke beelden en intu√Øtie.",
        7: "Bewustwording, zoeken naar zin, eerste grote levensvragen.",
        8: "Draagkracht, verantwoordelijkheid, werk en volwassen keuzes.",
        9: "Afronding van oude patronen, verdiepen en loslaten.",
      };
      const desc = themes[cycleIndex] || "Een verdiepende cyclus waar eerdere levensthema's zich op een nieuw niveau laten zien.";

      return { age, cycleIndex, startAge, endAge, desc };
    }

    // 3 levensfases ‚Äì simpel & symbolisch
    function getLifePhase(isoDate) {
      const age = getAgeYears(isoDate);
      if (age < 28) {
        return {
          fase: "Versterkingsfase",
          uitleg: "In deze fase bouw je fundering: lichaam, identiteit, basisveiligheid en eerste levenskeuzes. Je probeert uit, valt en staat weer op."
        };
      } else if (age < 56) {
        return {
          fase: "Ontwakingsfase",
          uitleg: "In deze fase verschuift de aandacht van alleen 'doen' naar 'zijn': je gaat steeds meer voelen wat echt klopt voor jouw ziel en energie."
        };
      } else {
        return {
          fase: "Meesterfase",
          uitleg: "In deze fase komt ervaring samen met wijsheid. Je deelt meer, begeleidt anderen vanzelf en leeft meer vanuit de essentie van wie je bent."
        };
      }
    }

    // Persoonlijk jaar (symbolische numerologie)
    function getPersonalYear(isoDate) {
      const [y, m, d] = isoDate.split("-").map(n => parseInt(n, 10));
      const today = new Date();
      const currentYear = today.getFullYear();
      const sum = d + m + currentYear
        .toString()
        .split("")
        .map(n => parseInt(n, 10))
        .reduce((a, b) => a + b, 0);
      const yearNum = digitSum(sum);

      const themes = {
        1: "Nieuw begin, zaaien, initiatief nemen, keuzes maken die echt bij jou horen.",
        2: "Verbinding, relaties, samenwerken, geduld en emotionele verfijning.",
        3: "Expressie, creativiteit, jezelf laten zien, spelen en experimenteren.",
        4: "Structuur, fundament, hard werken aan iets dat langer mee mag gaan.",
        5: "Verandering, beweging, vrijheid, onverwachte wendingen en flexibiliteit.",
        6: "Zorg, familie, hartzaken, verantwoordelijkheid in relaties en thuis.",
        7: "Verstilling, innerlijk onderzoek, spiritualiteit, verdieping en studie.",
        8: "Oogst, leiderschap, grenzen, materi√´le thema's en impact.",
        9: "Loslaten, afronden, vergeving, opruimen en voorbereiden op een nieuwe cyclus."
      };

      return {
        yearNum,
        desc: themes[yearNum] || "Een jaar van innerlijke verschuivingen en groei waarin oude en nieuwe thema's elkaar afwisselen."
      };
    }

    // ------------------------------
    // DeLuxe-secties
    // ------------------------------
    function describeBaseChakra(base) {
      const meta = chakraMeta[base];
      if (!meta) return "";
      return `
        <h2>1. Basischakra (kernenergie)</h2>
        <p><span class="badge">KERN</span></p>
        <p><strong>Basischakra:</strong> ${meta.naam}</p>
        <p><strong>Kernenergie:</strong> ${meta.kern}</p>
        <p>Dit betekent dat jouw diepste energie zich richt op deze thema&#39;s. Dit kleurt je persoonlijkheid, je keuzes en de manier waarop je in het leven staat.</p>
      `;
    }

    function describeFirstSum(firstSum, boven, onder) {
      let bovenTxt = chakraMeta[boven] ? chakraMeta[boven].kern : "";
      let onderTxt = onder && chakraMeta[onder] ? chakraMeta[onder].kern : null;

      let html = `
        <h2>2. Eerste som (dubbele energie)</h2>
        <p><span class="badge">LEVENSLADING</span></p>
        <p><strong>Eerste som:</strong> ${firstSum}</p>
        <p><strong>Bovenstroom (${boven}):</strong> ${bovenTxt}</p>
      `;
      if (onder !== null) {
        html += `<p><strong>Onderstroom (${onder}):</strong> ${onderTxt}</p>
        <p>De bovenstroom laat zien welk thema het meest zichtbaar is in je leven; de onderstroom laat voelen wat er onder de oppervlakte meespeelt. Samen vormen ze een spanningsveld of samenwerking tussen deze twee chakra-kwaliteiten.</p>`;
      } else {
        html += `<p>Je eerste som is enkelcijferig; je basischakra en je levenslading vallen hier samen.</p>`;
      }
      return html;
    }

    function describeDistribution(counts) {
      let pills = "";
      for (let i = 1; i <= 9; i++) {
        pills += `<span class="pill">${i}: ${counts[i]}√ó</span>`;
      }
      const zeroPill = `<span class="pill">0: ${counts[0]}√ó</span>`;

      const sterke = [];
      const stabiel = [];
      const ontbreekt = [];
      for (let i = 1; i <= 9; i++) {
        if (counts[i] >= 2) sterke.push(i);
        else if (counts[i] === 1) stabiel.push(i);
        else ontbreekt.push(i);
      }

      let html = `
        <h2>3. Chakra-verdeling (energiekaart)</h2>
        <p><span class="badge">OVERZICHT</span></p>
        <p>Zo zijn de cijfers van je geboortedatum verdeeld over de chakra&#39;s:</p>
        <p>${pills} ${zeroPill}</p>
      `;

      if (sterke.length) {
        html += `<p><strong>Sterk aanwezige chakra&#39;s:</strong> ${sterke.join(", ")} ‚Äì deze energie√´n zijn duidelijk voelbaar in je persoonlijkheid.</p>`;
      }
      if (stabiel.length) {
        html += `<p><strong>Stabiele chakra&#39;s:</strong> ${stabiel.join(", ")} ‚Äì deze thema&#39;s zijn aanwezig, zonder extreme nadruk.</p>`;
      }
      if (ontbreekt.length) {
        html += `<p><strong>Ontbrekende chakra&#39;s:</strong> ${ontbreekt.join(", ")} ‚Äì deze kwaliteiten ontwikkelen zich vooral via levenservaring en relaties.</p>`;
      }
      if (counts[0] > 0) {
        html += `<p><strong>0-energie (${counts[0]}√ó):</strong> ${zeroMeta.uitleg}</p>`;
      }

      return html;
    }

    function describeStrengths(counts, base) {
      const bullets = [];

      for (let i = 1; i <= 9; i++) {
        if (counts[i] >= 2) {
          const meta = chakraMeta[i];
          bullets.push(`<strong>${meta.naam}:</strong> ${meta.kracht}`);
        }
      }
      if (chakraMeta[base]) {
        bullets.push(`<strong>Basischakra ${base}:</strong> ${chakraMeta[base].kracht}`);
      }
      if (counts[0] >= 2) {
        bullets.push(`<strong>0-energie:</strong> je hebt een groot innerlijk potentieel en bent gevoelig voor energie en sfeer. Dit maakt je fijngevoelig en intu√Øtief, mits je goed gegrond blijft.`);
      } else if (counts[0] === 1) {
        bullets.push(`<strong>0-energie:</strong> je hebt een open gevoeligheid voor subtiele signalen en energie√´n, die je kunt inzetten als innerlijke antenne.`);
      }

      if (!bullets.length) {
        bullets.push("Je hebt een gelijkmatige verdeling zonder extreem dominante thema's; jouw kracht zit juist in balans en veelzijdigheid.");
      }

      return `
        <h2>4. Krachten & talenten</h2>
        <p><span class="badge">KRACHTVELD</span></p>
        <p>Op basis van je chakra-verdeling vallen de volgende krachtvelden op:</p>
        <ul>${bullets.map(b => `<li>${b}</li>`).join("")}</ul>
      `;
    }

    function describeShadows(counts) {
      const bullets = [];

      for (let i = 1; i <= 9; i++) {
        if (counts[i] === 0) {
          const meta = chakraMeta[i];
          bullets.push(`<strong>${meta.naam}:</strong> ${meta.groei}`);
        }
      }

      if (counts[8] >= 2) {
        bullets.push(`<strong>Veel 8-energie:</strong> je kunt snel te veel verantwoordelijkheid op je nemen. Je schaduw zit in het gevoel dat jij alles moet dragen. Je groei zit in leren loslaten en hulp aannemen.`);
      }
      if (counts[4] >= 2) {
        bullets.push(`<strong>Veel 4-energie:</strong> je geeft veel vanuit je hart, maar kunt jezelf daarbij soms vergeten. Je groei zit in grenzen stellen en leren ontvangen.`);
      }
      if (counts[0] >= 3) {
        bullets.push(`<strong>Veel 0-energie:</strong> je bent zeer gevoelig en open voor indrukken. Je mag extra investeren in gronding, rust en fysieke zelfzorg.`);
      }

      if (!bullets.length) {
        bullets.push("Je schaduw ligt niet zozeer in √©√©n specifiek chakra, maar in de balans tussen geven en ontvangen, spreken en luisteren, denken en voelen. Kleine bewuste keuzes brengen hier veel.");
      }

      return `
        <h2>5. Schaduwkanten & groeipunten</h2>
        <p><span class="badge">GROEI</span></p>
        <p>Schaduw is geen fout, maar een uitnodiging tot groei. Bij jou vallen de volgende groeigebieden op:</p>
        <ul>${bullets.map(b => `<li>${b}</li>`).join("")}</ul>
      `;
    }

    function describeEmotionalProfile(counts, base) {
      const aanwezig2 = counts[2] > 0;
      const aanwezig4 = counts[4] > 0;
      const aanwezig5 = counts[5] > 0;
      const veel0 = counts[0] >= 2;

      let hoeVoelt = [];
      let hoeVerwerkt = [];
      let opent = [];
      let sluit = [];
      let nodig = [];

      if (aanwezig2 || aanwezig4) {
        hoeVoelt.push("je voelt veel, en je binnenwereld is rijk en gevoelig.");
        hoeVerwerkt.push("je verwerkt ervaringen deels via gevoel en deels via nadenken.");
        opent.push("echte verbinding, zachtheid en mensen die oprecht ge√Ønteresseerd zijn.");
        nodig.push("ruimte om je gevoel te laten landen zonder dat je meteen hoeft te ‚Äòfunctioneren‚Äô.");
      } else {
        hoeVoelt.push("je voelt vaak eerst via je lichaam of je gedachten, en pas later als duidelijk gevoel.");
        hoeVerwerkt.push("je verwerkt stap voor stap, via nadenken, structureren en ordenen.");
        nodig.push("duidelijkheid, uitleg en tijd om te begrijpen wat je voelt.");
      }

      if (aanwezig5) {
        hoeVerwerkt.push("woorden helpen je om emoties op te ruimen; praten kan helend voor je zijn.");
        opent.push("eerlijk en rustig gesprek, zonder oordeel.");
        sluit.push("situaties waarin je het gevoel hebt dat je niet mag uitspreken wat je ervaart.");
      } else {
        sluit.push("druk om te praten als je er nog geen woorden voor hebt.");
      }

      if (veel0) {
        hoeVoelt.push("je bent gevoelig voor sfeer, blikken en onuitgesproken dingen.");
        nodig.push("rust, prikkelarme momenten en tijd alleen om bij jezelf te komen.");
      }

      if (base === 7 || base === 6) {
        hoeVerwerkt.push("je verwerkt veel via inzicht: je wilt begrijpen waarom iets zo voelt.");
      }

      return `
        <h2>6. Emotionele blauwdruk</h2>
        <p><span class="badge">GEVOEL</span></p>
        <p><strong>Hoe je meestal voelt:</strong> ${hoeVoelt.join(" ")}</p>
        <p><strong>Hoe je meestal verwerkt:</strong> ${hoeVerwerkt.join(" ")}</p>
        <p><strong>Wat je opent (emotioneel veilig voelt):</strong> ${opent.join(" ") || "echte aandacht, zachtheid en een rustige sfeer."}</p>
        <p><strong>Wat je sluit (emotioneel spanning geeft):</strong> ${sluit.join(" ") || "druk, oordeel en chaos zonder duidelijkheid."}</p>
        <p><strong>Wat je nodig hebt:</strong> ${nodig.join(" ")}</p>
      `;
    }

    function describeRelationProfile(counts) {
      const veel1 = counts[1] >= 2;
      const veel4 = counts[4] >= 2 || counts[4] === 1;
      const veel8 = counts[8] >= 2 || counts[8] === 1;
      const veel0 = counts[0] >= 2;
      const heeft2 = counts[2] > 0;
      const heeft5 = counts[5] > 0;

      let liefdesstijl = [];
      let geef = [];
      let ontvang = [];
      let veilig = [];
      let spanning = [];
      let groei = [];

      if (veel1 || veel8) {
        liefdesstijl.push("je liefde uit zich in stabiliteit, verantwoordelijkheid en er √©cht zijn voor de mensen om wie je geeft.");
        geef.push("je bent betrouwbaar, draagt mee en denkt vooruit.");
        veilig.push("duidelijke afspraken, voorspelbaarheid en trouw.");
      }
      if (veel4 || heeft2) {
        liefdesstijl.push("je zoekt verbinding op hartniveau; je wil dat het ergens over g√°√°t.");
        geef.push("je bent zorgzaam, empathisch en bereid om te luisteren.");
        ontvang.push("je ontvangt liefde het liefst in de vorm van oprechte aandacht en tijd samen.");
      }
      if (heeft5) {
        liefdesstijl.push("je vindt eerlijkheid en communicatie belangrijk in relaties.");
        geef.push("je bent bereid dingen uit te spreken als het belangrijk is.");
        spanning.push("spelletjes, onduidelijkheid en niet weten waar je aan toe bent.");
      } else {
        groei.push("je mag jezelf vaker uitspreken over wat je nodig hebt in relaties, ook als dat spannend voelt.");
      }

      if (veel0) {
        spanning.push("te veel prikkels, drama of emotionele onrust in je omgeving.");
        veilig.push("mensen die rustig, consistent en veilig aanvoelen.");
      }

      if (!liefdesstijl.length) {
        liefdesstijl.push("je benadert relaties rustig en stap voor stap; je vertrouwt liever op daden dan op mooie woorden.");
      }
      if (!groei.length) {
        groei.push("balans vinden tussen zorgen voor de ander en zorgen voor jezelf.");
      }

      return `
        <h2>7. Relationele energie & verbinding</h2>
        <p><span class="badge">RELATIES</span></p>
        <p><strong>Jouw liefdesstijl:</strong> ${liefdesstijl.join(" ")}</p>
        <p><strong>Hoe je geeft in relaties:</strong> ${geef.join(" ") || "je geeft vooral door er te zijn en mee te denken met de ander."}</p>
        <p><strong>Hoe je ontvangt:</strong> ${ontvang.join(" ") || "ontvangen mag nog wat meer ruimte innemen; je bent eerder gever dan ontvanger."}</p>
        <p><strong>Wat je veiligheid geeft in relaties:</strong> ${veilig.join(" ") || "eerlijkheid, respect en mensen die doen wat ze zeggen."}</p>
        <p><strong>Wat je spanning geeft in relaties:</strong> ${spanning.join(" ") || "onduidelijkheid, wisselende signalen en emotionele druk."}</p>
        <p><strong>Jouw groei in relaties:</strong> ${groei.join(" ")}</p>
      `;
    }

    function describeInnerChild(counts) {
      const veel8 = counts[8] >= 2 || counts[1] >= 2;
      const heeft2 = counts[2] > 0 || counts[4] > 0;
      const veel0 = counts[0] >= 2;

      let voelt = [];
      let nodig = [];
      let belofte = [];

      if (veel8) {
        voelt.push("al vroeg verantwoordelijk, alsof je ‚Äòsterk moest zijn‚Äô of voor anderen moest zorgen.");
        nodig.push("dat jij nu tegen jezelf zegt dat je niet alles meer alleen hoeft te doen.");
      }
      if (heeft2) {
        voelt.push("gevoelig en verlangend naar echte aandacht en gezien worden.");
        nodig.push("zachtheid, ruimte voor gevoel en iemand die luistert zonder oordeel.");
      }
      if (veel0) {
        voelt.push("erg open en gevoelig voor sfeer, wat soms overweldigend kon zijn.");
        nodig.push("rust, voorspelbaarheid en een veilige plek om op te laden.");
      }

      if (!voelt.length) {
        voelt.push("serieus, observerend en misschien wat op de achtergrond.");
        nodig.push("dat je nu erkenning geeft aan jouw tempo, jouw manier van voelen en jouw behoefte aan rust.");
      }

      belofte.push("Ik zal beter naar je luisteren.");
      belofte.push("Ik zal vaker kiezen voor rust en zachtheid.");
      belofte.push("Ik zal niet meer van je eisen dat je alles perfect doet.");

      return `
        <h2>8. Innerlijk kind (symbolische heling)</h2>
        <p><span class="badge">INNERLIJK KIND</span></p>
        <p><strong>Hoe jouw innerlijk kind zich waarschijnlijk heeft gevoeld:</strong> ${voelt.join(" ")}</p>
        <p><strong>Wat het nu van jou nodig heeft:</strong> ${nodig.join(" ")}</p>
        <p><strong>Innerlijk-kind belofte:</strong></p>
        <ul>${belofte.map(b => `<li>${b}</li>`).join("")}</ul>
      `;
    }

    // Chakra-oefeningen sectie (voor minder aanwezige chakra's)
    function describeChakraExercises(counts) {
      const weak = []; // 0x of 1x = ontwikkelpunt
      for (let i = 1; i <= 9; i++) {
        if (counts[i] <= 1) weak.push(i);
      }
      if (!weak.length) {
        return `
          <h2>9. Chakra-oefeningen voor jouw pad</h2>
          <p><span class="badge">PRAKTIJK</span></p>
          <p>Je hebt een relatief gebalanceerde verdeling over de chakra&#39;s. Oefeningen kunnen je vooral helpen om balans te onderhouden. Kies intu√Øtief √©√©n chakra-oefening die je aanspreekt en herhaal die een week lang.</p>
        `;
      }

      let sections = weak.map(num => {
        const meta = chakraMeta[num];
        const ex = chakraExercises[num];
        if (!meta || !ex) return "";
        return `
          <h3>${meta.naam}</h3>
          <p><strong>Waarom dit chakra een groeivelden is:</strong> ${meta.groei}</p>
          <p><strong>Oefening:</strong> ${ex.titel}</p>
          <p>${ex.korte}</p>
          <ul>${ex.stappen.map(s => `<li>${s}</li>`).join("")}</ul>
        `;
      }).join("");

      return `
        <h2>9. Chakra-oefeningen voor ontwikkeling</h2>
        <p><span class="badge">PRAKTIJK</span></p>
        <p>Hieronder vind je concrete, zachte oefeningen voor de chakra&#39;s die bij jou minder sterk of maar √©√©n keer aanwezig zijn in je geboortedatum. Zie het als uitnodiging, niet als verplichting.</p>
        ${sections}
      `;
    }

    // 7-jarige zielscyclus + levensfases
    function describeSoulCycleSection(isoDate) {
      const { age, cycleIndex, startAge, endAge, desc } = getSoulCycle(isoDate);
      const lifePhase = getLifePhase(isoDate);

      return `
        <h2>10. 7-jarige zielscyclus & levensfasen</h2>
        <p><span class="badge">ZIELSCYCLUS</span></p>
        <p><strong>Huidige leeftijd (benaderd):</strong> ${age} jaar</p>
        <p><strong>Huidige 7-jarige zielscyclus:</strong> cyclus ${cycleIndex} (ongeveer ${startAge} t/m ${endAge} jaar)</p>
        <p><strong>Thema van deze cyclus:</strong> ${desc}</p>
        <p>Elke cyclus van zeven jaar brengt een andere kleur in je leven. Je hoeft niet exact op leeftijdsniveau te voelen wat hier staat; het gaat om een zachte, symbolische richting.</p>
        <h3>Levenspad in drie hoofdredes</h3>
        <p><strong>Jouw huidige fase:</strong> ${lifePhase.fase}</p>
        <p>${lifePhase.uitleg}</p>
        <ul>
          <li><strong>Versterkingsfase:</strong> opbouw van identiteit, lichaam, ego, grenzen en basisveiligheid.</li>
          <li><strong>Ontwakingsfase:</strong> verschuiving van ‚Äúmoeten‚Äù naar ‚Äúwillen‚Äù, meer innerlijk voelen en bewustwording.</li>
          <li><strong>Meesterfase:</strong> oogsten van ervaring, delen van wijsheid, leven dichter bij de essentie.</li>
        </ul>
      `;
    }

    // Zielscontract familie & partners (symbolisch)
    function describeSoulContracts(counts, base) {
      const has4 = counts[4] > 0;
      const has2 = counts[2] > 0;
      const has8 = counts[8] > 0;
      const has9 = counts[9] > 0;
      const has0 = counts[0] > 0;

      let familie = [];
      let partners = [];

      if (has4 || has2) {
        familie.push("Je ziel lijkt via familie uitgenodigd te zijn om liefde, nabijheid en emotionele verbinding te leren. Soms via warmte, soms via het gemis daarvan.");
      }
      if (has8 || counts[1] > 1) {
        familie.push("Er is een thema van verantwoordelijkheid: je kan het gevoel hebben (gehad) dat jij stevig moest zijn binnen je systeem.");
      }
      if (has0) {
        familie.push("Je gevoeligheid maakt dat je spanningen in de familie snel aanvoelt; jouw ziel zoekt naar meer zachtheid en eerlijkheid.");
      }
      if (!familie.length) {
        familie.push("Je zielscontract met je familie lijkt vooral te gaan over ruimte innemen als jezelf, zonder je volledig aan te passen.");
      }

      if (has4 || has2) {
        partners.push("In partnerrelaties zoekt je ziel naar echte emotionele afstemming, dieper vertrouwen en hart-tot-hart verbinding.");
      }
      if (has5) {
        partners.push("Communicatie is een belangrijk contractthema: eerlijk durven spreken, maar ook durven luisteren.");
      }
      if (has8) {
        partners.push("Je leert in relaties dat je niet alles hoeft te dragen en dat gelijkwaardigheid essentieel is.");
      }
      if (!partners.length) {
        partners.push("In partnerrelaties lijkt je ziel te willen leren hoe je verbonden kunt zijn zonder jezelf kwijt te raken.");
      }

      return `
        <h2>11. Zielscontract ‚Äì familie & partners</h2>
        <p><span class="badge">ZIELSVERBINDING</span></p>
        <h3>Familielijnen</h3>
        <p>${familie.join(" ")}</p>
        <h3>Partners & intieme relaties</h3>
        <p>${partners.join(" ")}</p>
        <p class="muted">Dit gaat niet over schuld of vaste waarheden, maar over uitnodigingen: welke lessen lijken steeds terug te komen in je verbindingen?</p>
      `;
    }

    // Karmische lijnen & littekens (symbolisch, zacht)
    function describeKarmicLines(counts, base) {
      let lijnen = [];
      let littekens = [];

      if (counts[8] >= 2) {
        lijnen.push("Een karmische lijn rond verantwoordelijkheid en macht: je ziel lijkt te leren hoe je kracht kunt inzetten zonder jezelf te verliezen in dragen.");
        littekens.push("Gevoel dat je te veel moet of moest doen voor anderen, moeite met hulp vragen.");
      }
      if (counts[4] >= 2) {
        lijnen.push("Een karmische lijn rond hart en liefde: lessen in geven, ontvangen en eigenwaarde in relaties.");
        littekens.push("Pijn rond afwijzing of niet gezien voelen in je zachtheid.");
      }
      if (counts[0] >= 2) {
        lijnen.push("Een karmische lijn rond gevoeligheid: je ziel draagt mogelijk oude ervaringen van overprikkeling of ‚Äòte open‚Äô zijn.");
        littekens.push("Moeite om je helemaal veilig te voelen in je eigen energie.");
      }
      if (counts[3] === 0) {
        lijnen.push("Een karmische lijn rond eigen kracht en keuzes: je ziel mag leren zelf richting te bepalen, los van verwachtingen.");
      }
      if (!lijnen.length) {
        lijnen.push("Je karmische lijnen lijken niet op √©√©n thema vast te zitten, maar verspreid te zijn over meerdere gebieden: verantwoordelijkheid, verbinding en zelfexpressie.");
      }
      if (!littekens.length) {
        littekens.push("Je karmische littekens lijken vooral te gaan over momenten waarop je jezelf kleiner hebt gemaakt dan je daadwerkelijk bent.");
      }

      return `
        <h2>12. Karmische lijnen & littekens</h2>
        <p><span class="badge">KARMA</span></p>
        <h3>Karmische lijnen</h3>
        <p>${lijnen.join(" ")}</p>
        <h3>Karmische littekens</h3>
        <p>${littekens.join(" ")}</p>
        <p class="muted">Karma wordt hier niet gezien als straf, maar als een patroon van herhaling waar je ziel bewustzijn en mildheid in wil brengen.</p>
      `;
    }

    // Spirituele gidsen + archetypen + zielsdieren (symbolisch, niet letterlijk)
    function describeGuides(counts, base) {
      // Koppel globale archetypen aan dominante cijfers
      const archetypes = [];
      const animals = [];
      const energies = [];

      const strong = [];
      for (let i = 1; i <= 9; i++) {
        if (counts[i] >= 2) strong.push(i);
      }
      const dom = strong.length ? strong : [base];

      dom.forEach(num => {
        switch (num) {
          case 1:
            archetypes.push("De Beschermer / De Bouwer");
            animals.push("Beer (kracht & bescherming)");
            energies.push("Stevige, aardse gidsenergie die je helpt om te aarden en praktisch te blijven.");
            break;
          case 2:
            archetypes.push("De Verbinder / De Maanbewaker");
            animals.push("Dolfijn (speelse verbinding)");
            energies.push("Zachte, waterige gidsenergie die je helpt te voelen en te vertrouwen op je emotie.");
            break;
          case 3:
            archetypes.push("De Krijger van Licht");
            animals.push("Leeuw (moed & waardigheid)");
            energies.push("Vurig gerichte energie die je helpt keuzes te maken en je plek in te nemen.");
            break;
          case 4:
            archetypes.push("De Hartwachter");
            animals.push("Hert (gevoelig & alert)");
            energies.push("Zachte, groene hartenergie die je begeleidt in liefde, empathie en compassie.");
            break;
          case 5:
            archetypes.push("De Boodschapper");
            animals.push("Vogel (overzicht & stem)");
            energies.push("Luchtige, blauwe gidsenergie die je helpt je waarheid te spreken.");
            break;
          case 6:
            archetypes.push("De Ziener");
            animals.push("Uil (wijsheid & nachtzicht)");
            energies.push("Intu√Øtieve, paars-indigo energie die patronen onthult en je inzichten fluistert.");
            break;
          case 7:
            archetypes.push("De Wijze / De Monnik");
            animals.push("Kraai of Raaf (magische boodschapper)");
            energies.push("Diepe spirituele energie die je uitnodigt tot verstilling en contemplatie.");
            break;
          case 8:
            archetypes.push("De Hoeder van de Poort");
            animals.push("Wolf (roedel & grensbewaker)");
            energies.push("Sterke, goud-witte energie die je helpt bij grenzen, leiderschap en integriteit.");
            break;
          case 9:
            archetypes.push("De Oude Ziel");
            animals.push("Vlinder (transformatie)");
            energies.push("Zilverwitte bronenergie die je herinnert aan afronding, vergeving en loslaten.");
            break;
        }
      });

      return `
        <h2>13. Spirituele gidsen, archetypen & zielsdieren</h2>
        <p><span class="badge">SYMBOLIEK</span></p>
        <p>Onderstaande beelden zijn symbolische spiegels, geen letterlijke waarheden. Voel vooral wat voor jou resoneert.</p>
        <p><strong>Mogelijke gids-archetypen die bij jouw energie passen:</strong> ${[...new Set(archetypes)].join(", ")}</p>
        <p><strong>Zielsdieren (symbolisch):</strong> ${[...new Set(animals)].join(", ")}</p>
        <p><strong>Energie van je gidsen:</strong> ${energies.join(" ")}</p>
      `;
    }

    // Persoonlijke jaarvoorspelling (symbolisch)
    function describePersonalYear(isoDate) {
      const { yearNum, desc } = getPersonalYear(isoDate);
      const currentYear = new Date().getFullYear();

      return `
        <h2>14. Persoonlijk jaar & jaartrilling</h2>
        <p><span class="badge">JAARTHEMA</span></p>
        <p><strong>Huidig kalenderjaar:</strong> ${currentYear}</p>
        <p><strong>Persoonlijk jaargetal:</strong> ${yearNum}</p>
        <p><strong>Symbolisch thema van dit jaar:</strong> ${desc}</p>
        <p class="muted">Zie dit niet als voorspelling, maar als een ondertoon: een soort jaarsfeer waarin bepaalde keuzes, lessen of kansen extra voelbaar kunnen zijn.</p>
      `;
    }

    // Werkelijke zielsmissie (samenvatting)
    function describeSoulMission(base, counts, firstSum) {
      const meta = chakraMeta[base];
      const strong = [];
      for (let i = 1; i <= 9; i++) {
        if (counts[i] >= 2) strong.push(i);
      }

      let missie = [];

      if (meta) {
        missie.push(`Je kernopdracht lijkt te liggen in het belichamen van de kwaliteiten van ${meta.naam.toLowerCase()}: ${meta.kern}.`);
      }

      if (strong.includes(8)) {
        missie.push("Een belangrijk deel van je zielsmissie gaat over het leren dragen zonder jezelf te verliezen: leiderschap vanuit hart en integriteit, niet vanuit dwang.");
      }
      if (strong.includes(4)) {
        missie.push("Je zielsmissie heeft een hartcomponent: liefde, verbinding en zachtheid brengen in systemen waar dit soms ontbreekt.");
      }
      if (strong.includes(7) || strong.includes(9)) {
        missie.push("Er zit een duidelijke wijsheidslijn in je missie: ervaringen doorleven, er inzicht uit halen en dit (bewust of onbewust) delen met anderen.");
      }
      if (!strong.length) {
        missie.push("Je zielsmissie lijkt niet vast te zitten op √©√©n thema; je bent hier om via verschillende rollen, relaties en ervaringen steeds dichter bij je eigen waarheid te komen.");
      }

      return `
        <h2>15. Werkelijke zielsmissie</h2>
        <p><span class="badge">ESSENTIE</span></p>
        <p>${missie.join(" ")}</p>
        <p>Je zielsmissie is geen taaklijst, maar een onderliggende richting: een manier van aanwezig zijn in de wereld die klopt met wie je van binnen bent.</p>
      `;
    }

    // Slot
    function describeConclusion(base) {
      const meta = chakraMeta[base];
      return `
        <h2>16. Samenvatting & integratie</h2>
        <p><span class="badge">INTEGRATIE</span></p>
        <p>Je Chakra Code DeLuxe rapport brengt verschillende lagen samen: energie, emotie, relaties, zielscycli en symbolische karmische thema&#39;s. Het is geen absolute waarheid, maar een uitnodiging om op een andere manier naar jezelf te kijken.</p>
        <p><strong>Kern:</strong> jouw basischakra (${meta ? meta.naam : "je basischakra"}) nodigt je uit om steeds meer in lijn te komen met wie je van nature bent. Jouw weg is geen rechte lijn, maar een beweging van leren, loslaten en terugkeren naar jezelf.</p>
        <p class="muted">Neem mee wat resoneert, laat los wat nu (nog) niet past. Jij bent altijd de vrije co-creator van je eigen pad.</p>
      `;
    }

    // ------------------------------
    // Rapport opbouwen
    // ------------------------------
    function buildReport(data) {
      const { name, dateDisplay, digits, firstSum, baseChakra, counts, boven, onder, isoDate } = data;
      const titleName = name && name.trim() ? name.trim() : "Deze persoon";

      let intro = `
        <h2>Overzicht DeLuxe Rapport</h2>
        <p><strong>Naam (optioneel):</strong> ${name && name.trim() ? name.trim() : "‚Äì niet ingevuld ‚Äì"}</p>
        <p><strong>Geboortedatum:</strong> ${dateDisplay}</p>
        <p><strong>Cijfers van de geboortedatum:</strong> ${digits.join(", ")}</p>
        <p><strong>Eerste som:</strong> ${firstSum}</p>
        <p><strong>Basischakra:</strong> ${baseChakra}</p>
        <p class="muted">${titleName} wordt in dit rapport beschreven op een symbolische, psychologisch-spirituele manier. Niets ligt vast; alles is bedoeld als uitnodiging tot zelfinzicht en groei.</p>
      `;

      const html = `
        ${intro}
        ${describeBaseChakra(baseChakra)}
        ${describeFirstSum(firstSum, boven, onder)}
        ${describeDistribution(counts)}
        ${describeStrengths(counts, baseChakra)}
        ${describeShadows(counts)}
        ${describeEmotionalProfile(counts, baseChakra)}
        ${describeRelationProfile(counts)}
        ${describeInnerChild(counts)}
        ${describeChakraExercises(counts)}
        ${describeSoulCycleSection(isoDate)}
        ${describeKarmicLines(counts, baseChakra)}
        ${describeGuides(counts, baseChakra)}
        ${describePersonalYear(isoDate)}
        ${describeSoulMission(baseChakra, counts, firstSum)}
        ${describeConclusion(baseChakra)}
        <div class="report-footer">
          Rapport gegenereerd door <strong>nieuwealchemist.nl</strong>
        </div>
      `;

      return html;
    }

    function buildEmailSummary(data) {
      const { name, dateDisplay, firstSum, baseChakra, isoDate } = data;
      const titleName = name && name.trim() ? name.trim() : "Deze persoon";
      const { yearNum } = getPersonalYear(isoDate);

      return `
Chakra Code DeLuxe Rapport ‚Äì Korte Samenvatting

Naam: ${titleName}
Geboortedatum: ${dateDisplay}

Eerste som (levenslading): ${firstSum}
Basischakra (kernenergie): ${baseChakra}
Persoonlijk jaargetal (symbolisch): ${yearNum}

Dit is een beknopte samenvatting van het uitgebreide Chakra Code DeLuxe rapport.
Voor de volledige analyse kun je terugkeren naar de website waar je het rapport hebt aangemaakt.

Alle duiding is symbolisch en bedoeld als uitnodiging tot zelfinzicht en persoonlijke groei.

Rapport gegenereerd door nieuwealchemist.nl
      `.trim();
    }

    // ------------------------------
    // UI-logica
    // ------------------------------
    const btn = document.getElementById("analyzeBtn");
    const dobInput = document.getElementById("dob");
    const nameInput = document.getElementById("name");
    const emailInput = document.getElementById("email");
    const errorEl = document.getElementById("error");
    const reportEl = document.getElementById("report");
    const reportActions = document.getElementById("reportActions");
    const printBtn = document.getElementById("printBtn");
    const emailBtn = document.getElementById("emailBtn");

    let lastAnalysis = null;

    btn.addEventListener("click", () => {
      errorEl.style.display = "none";
      errorEl.textContent = "";
      reportEl.style.display = "none";
      reportEl.innerHTML = "";
      reportActions.style.display = "none";
      lastAnalysis = null;

      const isoDate = dobInput.value;
      if (!isoDate) {
        errorEl.textContent = "Vul eerst een geldige geboortedatum in.";
        errorEl.style.display = "block";
        return;
      }

      try {
        const baseData = analyzeDate(isoDate, nameInput.value);
        const data = { ...baseData, isoDate };
        const reportHtml = buildReport(data);
        reportEl.innerHTML = reportHtml;
        reportEl.style.display = "block";
        reportActions.style.display = "flex";
        lastAnalysis = data;
      } catch (e) {
        console.error(e);
        errorEl.textContent = "Er ging iets mis bij het berekenen. Controleer de datum.";
        errorEl.style.display = "block";
      }
    });

    printBtn.addEventListener("click", () => {
      if (!reportEl.innerHTML.trim()) return;
      window.print();
    });

    emailBtn.addEventListener("click", () => {
      if (!lastAnalysis) {
        errorEl.textContent = "Genereer eerst een rapport voordat je een e-mail maakt.";
        errorEl.style.display = "block";
        return;
      }
      const to = emailInput.value.trim();
      if (!to) {
        errorEl.textContent = "Vul eerst een e-mailadres in waar de samenvatting naartoe mag.";
        errorEl.style.display = "block";
        return;
      }
      errorEl.style.display = "none";
      errorEl.textContent = "";

      const subject = "Chakra Code DeLuxe Rapport ‚Äì Samenvatting";
      const body = buildEmailSummary(lastAnalysis);
      const mailto = `mailto:${encodeURIComponent(to)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
      window.location.href = mailto;
    });
  </script>
</body>
</html>
